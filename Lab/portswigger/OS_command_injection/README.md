# OS command injection
* [OS Command injection là gì ?](#khainiem)
* [Lab: OS command injection, simple case ](#lab1)
* [Lab: Blind OS command injection with time delays](#lab2)
* [Lab: Blind OS command injection with output redirection](#lab3)
* [Lab: Blind OS command injection with out-of-band interaction](#lab4)
* [Lab: Blind OS command injection with out-of-band data exfiltration](#lab5)
* [Một số các để injection command](#lab6)
# OS Command injection là gì ? <a name="khainiem">
  >Là một lỗ hổng cho phép chèn các command line của hệ điều hành và và thực thi nó trên máy chủ.
  <br>Đối với dạng đơn giản nhất thì khi ta chèn command line và thực thi thì trong phần HTTP response sẽ cho ra kết quả của command line ta chèn vào.
  <br>Blind thì khác mặc dù cũng chèn command line và cũng thực thi nhưng trong phần HTTP response không sẽ trả về kết quả của command line.
# Lab: OS command injection, simple case <a name="lab1">
  >Theo lab mô tả thì web có chứa chức năng thực hiện một command line có với 2 params  product and store ID sẽ trả về kết quả trong response
  ![image](https://user-images.githubusercontent.com/20487674/121918227-0c30a080-cd60-11eb-9634-50de8df8b15e.png)
  <br>Thấy params productId thì thử chèn một số command line và kết quả không thành công
  ![image](https://user-images.githubusercontent.com/20487674/121918851-a1339980-cd60-11eb-8ea2-f1c7390bd591.png)
  <br>Tìm endpoint khác<br>
  ![image](https://user-images.githubusercontent.com/20487674/121919146-ebb51600-cd60-11eb-8ca0-ee4cc76a25ab.png)
  <br>Lần này có vẻ khả quan :))
  ![image](https://user-images.githubusercontent.com/20487674/121919395-2f0f8480-cd61-11eb-8323-fc01ba3f9817.png)
  <br>Tiếp tục thử inject vào params storeId thì thành công
  ![image](https://user-images.githubusercontent.com/20487674/121920183-ff14b100-cd61-11eb-93a5-99a928bdf600.png)
# Lab: Blind OS command injection with time delays <a name="lab2">
  >Theo lab mô tả web có chứa chức năng thực hiện một command line  chứa detail do người dùng nhập và trong phần HTTP response không sẽ trả về kết quả của command line
  ![image](https://user-images.githubusercontent.com/20487674/121926756-7e0ce800-cd68-11eb-9b58-5a34b6776477.png)
  <br>Bắt request thực hiện fuzzing từng params ở Post body payload thì thử ping 8.8.8.8 (dns google nha) do lệnh ping có khoảng thời gian thực cho đến thực hiện xong 
  thì ta có thể độ thời gian phản hồi cho có thể cho biết lệnh ping đó có được thực thi hay không
  ![image](https://user-images.githubusercontent.com/20487674/121927618-7732a500-cd69-11eb-9b34-2f37a6c1cc07.png)
  ![image](https://user-images.githubusercontent.com/20487674/121928272-2e2f2080-cd6a-11eb-9f60-76698324f44e.png)
  <br>Cho đến paramas email thì cho kết quả thời gian phản hồi rất khá lớn so với các params trước đó ,từ đây có thể xác định được lệnh ping đã được thực thi
  ![image](https://user-images.githubusercontent.com/20487674/121929606-90d4ec00-cd6b-11eb-8e75-8eef83bb56b2.png)

  
  

  
  

  





  
